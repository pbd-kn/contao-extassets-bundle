// Attribute plugin for tinymce
tinymce.PluginManager.requireLangPack("attribute"),tinymce.PluginManager.add("attribute",function(t,e){var l=tinymce.majorVersion,a=tinymce.minorVersion;console.log("tinyversion attribute plugin: "+l+"."+a);var i=tinymce.util.I18n.translate,n=function(t,e){var l=tinymce.activeEditor.selection.getNode();l.attributes.length;if(e){var a=l.getAttribute(t);a?(l.setAttribute(t,""),l.setAttribute(t,a+" "+e)):l.setAttribute(t,e)}else l.removeAttribute(t)},o={title:"Attribute Dialog",tooltip:i("set/add/remove attributes. if the attribute value is empty, the attribute is deleted."),body:{type:"panel",items:[{type:"htmlpanel",html:"<div>erklaerung</div>"},{type:"htmlpanel",html:"<div>attribute</div>"},{type:"input",name:"Name",label:"Attribut Name",placeholder:i("Attribute name")},{type:"input",name:"Wert",label:"Attribut Wert",placeholder:i("value of the attribute. empty=remove")}]},buttons:[{type:"cancel",name:"closeButton",text:i("Cancel")},{type:"submit",name:"submitButton",text:i("Ok"),primary:!0}],onSubmit:function(t){var e=t.getData(),l=e.Name,a=e.Wert;console.log("Name: "+l+" Value: "+a),n(l,a),t.close()}},s={title:"Class Dialog",tooltip:"set/add/remove Classes. wenn Classwert existiert wird er geloescht.",body:{type:"panel",items:[{type:"htmlpanel",html:"<div>erklaerung</div>"},{type:"htmlpanel",html:"<div>attribute</div>"},{type:"input",name:"Name",label:"Class Name",placeholder:"Name class remove wenn exist"}]},buttons:[{type:"cancel",name:"closeButton",text:i("Cancel")},{type:"submit",name:"submitButton",text:i("Ok"),primary:!0}],onSubmit:function(t){var e=t.getData(),l=e.Name.toLowerCase().trim();e.Wert;console.log("Name: "+l);var a=!1,i="",o=tinymce.activeEditor.selection.getNode();for(let t=0;t<o.attributes.length;t++)if(nodeName="class"==o.attributes.item(t).nodeName.toLowerCase().trim()){const e=o.attributes.item(t).nodeValue.split(" ");for(let t=0;t<e.length;t++)e[t].toLowerCase().trim()!=l?0==i.length?i+=e[t].toLowerCase().trim():i+=" "+e[t].toLowerCase().trim():a=!0}console.log("classnames: "+i),a?(n("class",""),n("class",i)):(console.log("set "+l),n("class",l)),t.close()}},r={title:"Style Dialog",tooltip:"set/add/remove Styles. wenn Style existiert wird er geloescht.",body:{type:"panel",items:[{type:"htmlpanel",html:"<div>erklaerung</div>"},{type:"htmlpanel",html:"<div>attribute</div>"},{type:"input",name:"Name",label:"Style Name",placeholder:"Style remove wenn exist"},{type:"input",name:"Wert",label:"Style Wert",placeholder:"Wert des Style."}]},buttons:[{type:"cancel",name:"closeButton",text:i("Cancel")},{type:"submit",name:"submitButton",text:i("Ok"),primary:!0}],onSubmit:function(t){var e=t.getData(),l=e.Name.toLowerCase().trim(),a=e.Wert;console.log("Name: "+l+" Value: "+a);var i=!1,o="",s=tinymce.activeEditor.selection.getNode();for(let t=0;t<s.attributes.length;t++)if(nodeName="style"==s.attributes.item(t).nodeName.toLowerCase().trim()){const e=s.attributes.item(t).nodeValue.split(";");for(let a=0;a<e.length;a++)if(e[a]){const t=e[a].split(":");if(t[0].toLowerCase().trim()==l){i=!0;continue}o+=t[0].toLowerCase().trim()+":"+t[1]+";"}else console.log("item",t,"empty")}n("style",""),n("data-mce-style",""),i?(console.log("styles: submit "+o+" removeMe "+i),n("style",o),n("data-mce-style",o)):(o+=l+":"+a+";",console.log("styles: submit "+o+" removeMe "+i),n("style",o),n("data-mce-style",o)),t.close()}},m={title:"onclick Dialog",tooltip:"add/remove onklick. wenn onclick existiert wird er geloescht.",body:{type:"panel",items:[{type:"htmlpanel",html:"<div>erklaerung</div>"},{type:"htmlpanel",html:"<div>attribute</div>"},{type:"input",name:"Script",label:"js script",placeholder:"Javascript"}]},buttons:[{type:"cancel",name:"closeButton",text:i("Cancel")},{type:"submit",name:"submitButton",text:i("Ok"),primary:!0}],onSubmit:function(t){var e=t.getData().Script.toLowerCase().trim();console.log("script: ",e),n("onclick",""),e&&(";"==e.substr(-1)?n("onclick",e):n("onclick",e+";")),t.close()}};t.ui.registry.addMenuButton("Attribute",{text:"Attribute",icon:"code-sample",tooltip:"Attribute eintragen",fetch:function(e){e([{type:"menuitem",text:i("edit attribut"),onAction:function(){var e=tinymce.activeEditor.selection.getNode(),l=i("Inserting attributes allowed? (settings) tag")+": &lt;"+e.tagName+"&gt;";o.body.items[0]={type:"htmlpanel",html:l};var a="Vorhandene Attribute:",n=e.attributes.length;console.log("main anz attributes length: ",n);for(let t=0;t<e.attributes.length;t++)a+="<br>"+e.attributes.item(t).nodeName+"="+e.attributes.item(t).nodeValue;o.body.items[1]={type:"htmlpanel",html:a},t.windowManager.open(o)}},{type:"menuitem",text:i("edit class"),onAction:function(){var e=tinymce.activeEditor.selection.getNode();console.log("mainnode: ",e,"tag ",e.tagName);var l=i("Inserting classes allowed? (settings) tag")+": &lt;"+e.tagName+"&gt;";s.body.items[0]={type:"htmlpanel",html:l};var a="Vorhandene Class:",n=e.attributes.length;console.log("main anz class length: ",n);for(let t=0;t<e.attributes.length;t++)if(nodeName="class"==e.attributes.item(t).nodeName.toLowerCase().trim()){const l=e.attributes.item(t).nodeValue.split(" ");for(let t=0;t<l.length;t++)a+="<br>"+l[t]}s.body.items[1]={type:"htmlpanel",html:a},t.windowManager.open(s)}},{type:"menuitem",text:i("edit style"),onAction:function(){var e=tinymce.activeEditor.selection.getNode();console.log("mainnode: ",e,"tag ",e.tagName);var l=i("Inserting styles allowed? (settings) tag")+": &lt;"+e.tagName+"&gt;";r.body.items[0]={type:"htmlpanel",html:l};var a="Vorhandene Styles:";e.attributes.length;for(let t=0;t<e.attributes.length;t++)if(nodeName="style"==e.attributes.item(t).nodeName.toLowerCase().trim()){const l=e.attributes.item(t).nodeValue.split(";");console.log("main substyles anzahl styles "+l.length);for(let t=0;t<l.length;t++)console.log("main substyles  "+l.length),a+="<br>"+l[t]}r.body.items[1]={type:"htmlpanel",html:a},t.windowManager.open(r)}},{type:"menuitem",text:i("edit onclick"),onAction:function(){var e=tinymce.activeEditor.selection.getNode();console.log("mainnode: ",e,"tag ",e.tagName);var l=i("Inserting styles allowed? (settings) tag")+": &lt;"+e.tagName+"&gt;";m.body.items[0]={type:"htmlpanel",html:l};var a="Vorhandene Styles:";e.attributes.length;for(let t=0;t<e.attributes.length;t++)if(nodeName="onclick"==e.attributes.item(t).nodeName.toLowerCase().trim()){const l=e.attributes.item(t).nodeValue.split(";");console.log("main substyles anzahl styles "+l.length);for(let t=0;t<l.length;t++)console.log("main substyles  "+l.length),a+="<br>"+l[t]}m.body.items[1]={type:"htmlpanel",html:a},t.windowManager.open(m)}}])}})});
